abline(h=0,v=0)
mx = max(max(d$nChangeShopInBuyFromShopLookingForGoods), max(d$nChangeShopInSearchForShop))
z = d$nChangeShopInBuyFromShopLookingForGoods
plot(z, d$ConsumptionBudget / d$Price / corr, xlab="nChangeShopInBuyFromShopLookingForGoods",
ylab="Consumption", cex=0.5, cex.lab=0.7, xlim=c(0,mx), ylim=c(0,mx_y), main="black=budget, red=value",
cex.main=0.7)
lines(z, d$ConsumptionValue / d$Price / corr, col="red", cex=0.5, type="p")
abline(h=0,v=0)
z = d$nChangeShopInSearchForShop
plot(z, d$ConsumptionBudget / d$Price / corr, xlab="nChangeShopInSearchForShop",
ylab="Consumption", cex=0.5, cex.lab=0.7, xlim=c(0,mx), ylim=c(0,mx_y), main="black=budget, red=value",
cex.main=0.7)
lines(z, d$ConsumptionValue / d$Price / corr, col="red", cex=0.5, type="p")
abline(h=0,v=0)
#z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
#plot(z, d$ConsumptionValue / d$ConsumptionBudget, cex=0.5, cex.lab=0.7, xlim=c(0,1), ylim=c(0,1),
#     xlab="Share of unsuccesfull trades")
#abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$ConsumptionValue, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$nCouldNotFindFirmWithGoods, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$nChangeShopInBuyFromShopLookingForGoods, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$nChangeShopInSearchForShop, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
mx = max(max(d$nChangeShopInSearchForShop), max(d$nChangeShopInBuyFromShopLookingForGoods))
plot(d$nChangeShopInSearchForShop, d$nChangeShopInBuyFromShopLookingForGoods, xlab="nChangeShopInSearchForShop",
ylab="nChangeShopInBuyFromShopLookingForGoods", cex=0.5, cex.lab=0.7, log="xy", ylim=c(1,mx), xlim=c(1,mx), main="Log-scale")
abline(a=0,b=1, lty=2)
mx = max(max(d$nChangeShopInSearchForShop), max(d$nCouldNotFindFirmWithGoods))
plot(d$nChangeShopInSearchForShop, d$nCouldNotFindFirmWithGoods, xlab="nChangeShopInSearchForShop",
ylab="nCouldNotFindFirmWithGoods", cex=0.5, cex.lab=0.7, log="xy", ylim=c(1,mx), xlim=c(1,mx), main="Log-scale")
abline(a=0,b=1, lty=2)
#-----------------------------------------------
par(mfrow=c(3,3))
mn = min(d$ConsumptionValue)
mx = max(d$ConsumptionBudget)
plot(d$ConsumptionBudget, d$ConsumptionValue, cex=0.5, cex.lab=0.7, xlim=c(mn,mx), ylim=c(mn,mx))
abline(h=0, v=0)
abline(a=0,b=1,lty=2)
dev.off()
#-----------------------------------------------
if(F)
{
plot(d$Year, d$Sales/corr, type="l")
plot(d$Year, d$nEmployment, type="l")
plot(d$Year, d$PotensialSales/corr,  type="l")
plot(d_house$ConsumptionValue,  type="l")
plot(d$Year, d$PotensialSales/corr,  type="l", col="black")
lines(d$Year, d$Sales/corr,  col="red")
lines(d$Year, d$Production/corr,  col="blue")
lines(d$Year, 1000*d$nFirmNew,  col="green")
lines(d$Year, 15000-500*d$nFirmCloseNegativeProfit,  col="blue")
}
rm(list=ls())
#install.packages("forecast")
library(dplyr)
#library(forecast)
if(Sys.info()['nodename'] == "C1709161")    # PSP's machine
{
o_dir = "C:/test/Dream.AgentBased.MacroModel"
}
if(Sys.info()['nodename'] == "VDI00316")    # Fjernskrivebord
{
o_dir = "C:/Users/B007566/Documents/Output"
}
if(Sys.info()['nodename'] == "VDI00382")    # Fjernskrivebord
{
o_dir = "H:/AgentBased/SOE/Output"
#o_dir = "C:/Users/B007566/Documents/Output"
}
if(Sys.info()['nodename'] == "C2210098")     # Peters nye maskine
{
o_dir = "C:/Users/B007566/Documents/Output"
}
fast=T
hpfilter      = function(x, mu = 100) {
y = x
n <- length(y)          # number of observations
I <- diag(n)            # creates an identity matrix
D <- diff(I,lag=1,d=2)  # second order differences
d <- solve(I + mu * crossprod(D) , y) # solves focs
d
}
d = read.delim(paste0(o_dir,"/data_year.txt"))
d_house = read.delim(paste0(o_dir,"/data_households.txt"))
d_prod = read.delim(paste0(o_dir,"/data_firms.txt"))
if(!fast)
{
d_sector = read.delim(paste0(o_dir,"/sector_year.txt"))
}
#sum(d_house$ConsumptionValue==0)/nrow(d_house)
#df = read.delim(paste0(o_dir,"/household_reports.txt"))
#ddd = d_house %>% filter(ConsumptionValue==0 & ConsumptionBudget>0)
#ddd = d_house %>% filter(ConsumptionValue>0 & ConsumptionValue<0.0*ConsumptionBudget)
#hist(ddd$Age/12, breaks=50)
y0 = 2014
burnIn = 2035
alpha = 0.5
fi = 2
k = 2.5
g = (1 + 0.02)^(1/12) - 1
l_bar = k * (fi/(1-alpha))^(1/alpha) /(k - (1/(1-alpha)))
pdf(paste0(o_dir,"/graph1.pdf"))
par(mfrow=c(3,3))
yr = last(d$Year)
if(yr < 2020)
{
mx_yr = 2020
} else if(yr<2025)
{
mx_yr = 2025
} else if(yr<2050)
{
mx_yr = 2050
} else if(yr<2100)
{
mx_yr = 2100
} else if(yr<2200)
{
mx_yr = 2200
} else if(yr<2300)
{
mx_yr = 2300
} else
{
mx_yr = 2400
}
if(yr > 2100)
{
y0 = 2075
d = d %>% filter(Year>y0)
}
corr = (1 + 0.02)^(d$Year - y0)
cols=palette()
n_households = last(d$n_Households)
n_firms = n_households/l_bar
mx = max(d$ProfitPerHousehold)
plot(d$Year, d$ProfitPerHousehold, main="Profit Per Household", xlab = "year", ylab="",
type="l", xlim=c(y0,mx_yr), cex.main=0.8) #ylim=c(0,mx),
abline(h=0)
abline(v=burnIn, lty=2)
#hist(d_prod$Productivity, breaks = 50, xlab="Firm Productivity", main=paste("Year:",yr), col=cols[3])
mx = max(max(d_prod$OptimalEmployment), max(d_prod$Employment))
plot(d_prod$OptimalEmployment, d_prod$Employment, xlab="Optimal employment", ylab="Employment",
log = "xy", col=cols[3], xlim=c(1,1.1*mx), ylim=c(1,1.1*mx), cex=0.5)
abline(a=0,b=1, lty=2)
mx = max(max(d_prod$OptimalProduction), max(d_prod$Sales))
mn = min(min(d_prod$OptimalProduction), min(d_prod$Sales))
plot(d_prod$OptimalProduction, d_prod$Sales, xlab="Optimal production", ylab="Sales",
log = "xy", col=cols[3], xlim=c(1,1.1*mx), ylim=c(1,1.1*mx), cex=0.5)
abline(a=0,b=1, lty=2)
mx = max(max(d_house$ConsumptionValue), max(d_house$ConsumptionBudget))
mn = min(min(d_house$ConsumptionValue), min(d_house$ConsumptionBudget))
plot(d_house$ConsumptionBudget, d_house$ConsumptionValue, xlab="Budgetet consumption value", ylab="Actual consumption value",
col=cols[3], xlim=c(0,1.1*mx), ylim=c(0,1.1*mx), cex=0.5)
abline(a=0,b=1, lty=2)
#log = "xy",
mx = max(d$nUnemployed/d$LaborSupply)
if(last(d$nUnemployed/d$LaborSupply) < 0.2)
{
mx = 0.2
}
if(last(d$nUnemployed/d$LaborSupply) < 0.1)
{
mx = 0.1
}
if(last(d$nUnemployed/d$LaborSupply) < 0.05)
{
mx = 0.05
}
plot(d$Year, d$nUnemployed/d$LaborSupply, main="Unemployment rate", xlab = "year", ylab="",
type="l", xlim=c(y0,mx_yr), ylim=c(0,mx), cex.main=0.8)
abline(h=0)
abline(v=burnIn, lty=2)
mx = max(d$nOptimalEmplotment)
plot(d$Year, d$nOptimalEmplotment, main="Total Optimal Employment (Red: Actual empl.)", xlab = "year", ylab="Optimal Employment",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.1*mx), cex.main=0.8)
lines(d$Year, d$nEmployment, col="red")
abline(h=n_households, lty=2)
abline(v=burnIn, lty=2)
abline(h=0)
#z=d_prod$Profit<500
#z=d_prod$Profit[z]>-100
#hist(d_prod$Profit[z], breaks = 50, xlab="Profit", main="", col=cols[3])
mx = max(d$nVacancies/d$nEmployment)
if(last(d$nVacancies/d$nEmployment) < 0.2)
{
mx = 0.2
}
plot(d$Year, d$nVacancies/d$nEmployment, main="Vacancies rate", xlab = "year", ylab="",
type="l", xlim=c(y0,mx_yr), ylim=c(0,mx), cex.main=0.8)
abline(h=0)
abline(v=burnIn, lty=2)
mx = max(d$Wage / d$Price / corr)
plot(d$Year, d$Wage / d$Price / corr, main="", xlab = "year", ylab="Wage / Price",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.1*mx))
abline(h=0)
abline(v=burnIn, lty=2)
mx = max(max(d$Sales / corr), max(d$Consumption / corr))
plot(d$Year, d$Sales / corr, main="Sales (red=Consumption)", xlab = "year", ylab="sales",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.1*mx), cex.main=0.8)
lines(d$Year, d$Consumption / corr, col="red")
abline(h=0)
abline(v=burnIn, lty=2)
#-------
# Page 2
#-------
if(!fast)
{
mx = max(d$Wage)
plot(d$Year, d$Wage, xlab = "year", ylab="Wage", ylim=c(0,1.05*mx),
type="l", xlim=c(y0,mx_yr), main=paste("Year:",yr))
abline(h=0)
abline(v=burnIn, lty=2)
mx = max(d$Price)
plot(d$Year, d$Price, main="", xlab = "year", ylab="Price",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.05*mx))
abline(h=0)
abline(v=burnIn, lty=2)
mx = max(d$n_Households)
plot(d$Year, d$n_Households, main="", xlab = "year", ylab="#Households",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.05*mx))
abline(h=0)
lines(d$Year, d$LaborSupply, lty=2)
hist(d_house$Age/12, breaks = 100, xlab="Houshold age", main="", xlim=c(18,100), col=cols[3])
#plot(d$Year, d$ProfitPerHousehold/d$Price, main="", xlab = "year", ylab="ProfitHoush / Price",
#     type="l", xlim=c(y0,mx_yr))
#abline(h=0)
#abline(v=burnIn, lty=2)
#plot(d$Year, d$MeanValue, main="", type="l", xlim=c(y0,mx_yr), ylim=c(0, 1.1*max(d$MeanValue)),
#     ylab="MeanValue/Price", xlab="year")
#abline(h=0)
#abline(h=40, lty=2)
#abline(v=burnIn, lty=2)
plot(d$Year, d$MeanAge / 12, main="", type="l", xlim=c(y0,mx_yr), ylim=c(0, 1.1*max(d$MeanAge/12)), ylab="Mean firm age", xlab="year")
abline(h=0)
abline(v=burnIn, lty=2)
if(yr>burnIn)
{
dd = d %>% filter(Year>burnIn)
x_mx = max(dd$nUnemployed/dd$n_Households)
y_mx = max(dd$nVacancies/dd$n_Households)
plot(dd$nUnemployed/dd$n_Households, dd$nVacancies/dd$n_Households, main="Beveridge Curve",
xlab="U-rate", ylab="V-rate", type="p", pch=19, cex=0.3)
#        xlab="U-rate", ylab="V-rate", type="p", xlim=c(0,1.1*x_mx), ylim=c(0,1.1*y_mx), pch=19, cex=0.3)
abline(h=0,v=0)
}else
{
plot(0)
}
if(yr>burnIn)
{
dd = d %>% filter(Year>burnIn)
x_mx = max(dd$nUnemployed/dd$n_Households)
y_mx = max(d$Wage/lag(d$Wage)-1, na.rm = T)
y_mn = min(d$Wage/lag(d$Wage)-1, na.rm = T)
plot(dd$nUnemployed/dd$n_Households, dd$Wage/lag(dd$Wage)-1, main="Philips Curve",
xlab="U-rate", ylab="W-growth", type="p", pch=19, cex=0.3)
#       xlab="U-rate", ylab="W-growth", type="p", xlim=c(0,1.1*x_mx), ylim=c(1.1*y_mn,1.1*y_mx), pch=19, cex=0.3)
abline(h=0,v=0)
}else
{
plot(0)
}
z = d$Sales / d$nEmployment / corr
plot(d$Year, z, main="", type="l", xlim=c(y0,mx_yr), ylim=c(0, 1.1*max(z)), ylab="Productivity", xlab="year")
abline(h=0)
abline(v=burnIn, lty=2)
z = d_house$Productivity
z = z[z>0]
hist(z, breaks = 100, xlab="Household productivity", main="", xlim=c(0,3), col=cols[3])
abline(v=0, h=0)
#plot(d$Year, d$ProfitPerFirm, main="", xlab = "year", ylab="ProfitFirm",
#     type="l", xlim=c(y0,mx_yr))
#abline(h=0)
#abline(v=burnIn, lty=2)
#plot(d$Year, d$ProfitPerFirm/d$Price, main="", xlab = "year", ylab="ProfitFirm / Price",
#     type="l", xlim=c(y0,mx_yr))
#abline(h=0)
#abline(v=burnIn, lty=2)
#-------
# Page 3a
#-------
par(mfrow=c(3,1))
plot(d$Year, d$nFirms, main="", type="l", xlim=c(y0,mx_yr), ylim=c(0, 1.1*max(d$nFirms)), ylab="Stock of firms", xlab="year")
abline(h=0)
abline(v=burnIn, lty=2)
abline(h=n_firms, lty=2)
z = d$nFirmCloseNegativeProfit + d$nFirmCloseNatural + d$nFirmCloseTooBig
mx = max(max(z), max(d$nFirmNew))
plot(d$Year, z, xlab = "year", ylab="Flow of firms", ylim=c(0, 1.1*mx),
type="l", xlim=c(y0,mx_yr), main="", cex.main=0.7)
abline(h=120, lty=2)
lines(d$Year, d$nFirmNew, col=cols[2], type="l")
abline(h=0)
abline(v=burnIn, lty=2)
abline(v=2050, lty=2)
ContourFunctions::multicolor.title(c("Closed  ", "New"), 1:2, cex.main = 0.7)
plot(d$Year, d$SharpeRatio, main="", xlab = "year", ylab="SharpeRatio",
type="l", xlim=c(y0,mx_yr), col=cols[3])
lines(d$Year, d$ExpSharpRatio, col=cols[4])
abline(h=0)
abline(v=burnIn, lty=2)
ContourFunctions::multicolor.title(c("SharpeRatio  ","Expected SharpeRatio"), 3:4, cex.main = 0.7)
#-------
# Page 4
#-------
par(mfrow=c(3,3))
hist(d_prod$Age / 12, breaks = 50, xlab="Firm Age (years)", main=paste("Year:",yr))
plot(d_prod$Productivity, d_prod$Profit, xlab="Productivity",ylab="Profit", pch=19, cex=0.3)
abline(h=0)
barplot(log(table(d_house$UnemplDuration)), xlab="UnemplDuration (months)", ylab="log(Antal)")
plot(d_prod$Productivity, d_prod$Age/12, xlab="Productivity",ylab="Age (year)",
pch=19, cex=0.2)
abline(h=0)
abline(v=0.5, lty=2)
plot(d_prod$Age/12, d_prod$Profit, xlab="Age (year)",ylab="Profit",
pch=19, cex=0.2, xlim=c(0,50))
abline(h=0)
dd = d_house[sample(1:nrow(d_house),1000), ]
plot(dd$Age/12, dd$Productivity,pch=19, cex=0.1, xlab="Age (years)", ylab="Productivity", ylim=c(0,5))
mx = max(d$PotensialSales)
plot(d$Year, d$PotensialSales, main="Potensial sales (Red: Actual sales)", xlab = "year", ylab="Potensial sales",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.1*mx), cex.main=0.8)
lines(d$Year, d$Sales, col="red")
#abline(h=n_households, lty=2)
abline(v=burnIn, lty=2)
abline(h=0)
mx = max(max(d$ConsumptionValue / d$Price / corr), max(d$ConsumptionBudget / d$Price / corr))
plot(d$Year, d$ConsumptionValue / d$Price / corr, main="Consumption (black=value, red=budget)", xlab = "year", ylab="value",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1.1*mx), cex.main=0.8)
lines(d$Year, d$ConsumptionBudget / d$Price / corr, col="red")
abline(h=0)
abline(v=burnIn, lty=2)
plot(d$Year, d$ConsumptionValue / d$ConsumptionBudget, main="Consumption: Value as share of budget", xlab = "year", ylab="share",
type="l", xlim=c(y0,mx_yr), ylim=c(0,1), cex.main=0.8)
#-----------------------------------------------
par(mfrow=c(2,2))
S = length(unique(d_sector$Sector))
col = rainbow(S)
txt = "Employment"
mx = max(d_sector$Employment)
dd = d_sector %>% filter(Sector==0)
plot(dd$Time/12, dd$Employment, col=col[1], type="l", ylim=c(0,1.1*mx), ylab=txt, main=txt, xlab="Year")
for(i in 2:S)
{
dd = d_sector %>% filter(Sector==i-1)
lines(dd$Time/12, dd$Employment, col=col[i])
}
abline(h=0)
txt = "Number of Firms"
mx = max(d_sector$nFirm)
dd = d_sector %>% filter(Sector==0)
plot(dd$Time/12, dd$nFirm, col=col[1], type="l", ylim=c(0,1.1*mx), ylab=txt, main=txt, xlab="Year")
for(i in 2:S)
{
dd = d_sector %>% filter(Sector==i-1)
lines(dd$Time/12, dd$nFirm, col=col[i])
}
abline(h=0)
#d_sector = read.delim(paste0(o_dir,"/sector_year.txt"))
dd = d_sector %>% group_by(Time) %>% summarise(P=mean(Price))
d_sector2 = merge(dd, d_sector)
d_sector2$Price = d_sector2$Price / d_sector2$P
txt = "Relative Price"
mx = max(d_sector2$Price)
dd = d_sector2 %>% filter(Sector==0)
plot(dd$Time/12, dd$Price, col=col[1], type="l", ylim=c(0,1.1*mx), ylab=txt, main=txt, xlab="Year")
for(i in 2:S)
{
dd = d_sector2 %>% filter(Sector==i-1)
lines(dd$Time/12, dd$Price, col=col[i])
}
abline(h=0)
txt = "ExpSharpeRatio"
mx = max(d_sector$expSharpeRatio)
mn = min(d_sector$expSharpeRatio)
dd = d_sector %>% filter(Sector==0)
plot(dd$Time/12, dd$expSharpeRatio, col=col[1], type="l", ylim=c(1.2*mn,1.2*mx), ylab=txt, main=txt, xlab="Year")
for(i in 2:S)
{
dd = d_sector %>% filter(Sector==i-1)
lines(dd$Time/12, dd$expSharpeRatio, col=col[i])
}
abline(h=0)
lines(dd$Time/12, dd$expSharpeRatioTotal, lwd=2)
#-----------------------------------------------
par(mfrow=c(2,2))
vv = d_house$ConsumptionValue/d_house$ConsumptionBudget
vv = vv[!is.na(vv)]
hist(vv, xlab="Actual-Value/Budget", main="Consumption", breaks=150, xlim=c(-1,2))
infl = exp(diff(log(d$Price)))^12-1
mx = max(infl)
mn = min(infl)
if(mx < 0 ) mx=0
if(mn > 0 ) mn=0
plot(d$Year[-1], exp(diff(log(d$Price)))^12-1, type="l", ylim=c(mn, mx), ylab="", main="Inflation")
abline(h=0)
mx = max(d_house$Price)
hist(d_house$Price, breaks=50, xlim=c(0,1.2*mx))
d_h2 = d_house %>% filter(Wage>0)
mx = max(d_h2$Wage)
hist(d_h2$Wage, breaks=50, xlim=c(0,1.2*mx))
#p = d$Price[nrow(d)]
#hist(d_house$Price, breaks=50, xlim=c(0.2*p, 1.5*p))
#abline(v=p, col="red", lwd=2, lty=2)
#w = d$Wage[nrow(d)]
#d_h2 = d_house %>% filter(Wage>0)
#hist(d_h2$Wage, breaks=50, xlim=c(0.9*w, 1.1*w))
#abline(v=w, col="red", lwd=2, lty=2)
#-----------------------------------------------
par(mfrow=c(2,1))
mx=max(max(d$nChangeShopInBuyFromShopLookingForGoods), max(d$nChangeShopInSearchForShop))
plot(d$Year, d$nChangeShopInBuyFromShopLookingForGoods, type="l", ylim=c(0,1.1*mx), ylab="Number", main="Number of shops changes")
lines(d$Year, d$nChangeShopInBuyFromShopNull, col="blue")
lines(d$Year, d$nChangeShopInSearchForShop, col="red")
abline(h=0)
mx=max(d$ConsumptionValue / d$Price / corr)
plot(d$Year, d$ConsumptionValue / d$Price / corr, type="l", ylim=c(0,1.1*mx), ylab="Value", main="Consumption value")
abline(h=0)
}
#-----------------------------------------------
par(mfrow=c(3,3))
mx_y = max(d$ConsumptionBudget / d$Price / corr)
plot(d$nCouldNotFindFirmWithGoods, d$ConsumptionBudget / d$Price / corr, ylab="Consumption",
xlab="nCouldNotFindFirmWithGoods", cex=0.5, cex.lab=0.7, ylim=c(0,mx_y), main="black=budget, red=value",
cex.main=0.7)
lines(d$nCouldNotFindFirmWithGoods, d$ConsumptionValue / d$Price / corr, col="red", cex=0.5, type="p")
abline(h=0,v=0)
mx = max(max(d$nChangeShopInBuyFromShopLookingForGoods), max(d$nChangeShopInSearchForShop))
z = d$nChangeShopInBuyFromShopLookingForGoods
plot(z, d$ConsumptionBudget / d$Price / corr, xlab="nChangeShopInBuyFromShopLookingForGoods",
ylab="Consumption", cex=0.5, cex.lab=0.7, xlim=c(0,mx), ylim=c(0,mx_y), main="black=budget, red=value",
cex.main=0.7)
lines(z, d$ConsumptionValue / d$Price / corr, col="red", cex=0.5, type="p")
abline(h=0,v=0)
z = d$nChangeShopInSearchForShop
plot(z, d$ConsumptionBudget / d$Price / corr, xlab="nChangeShopInSearchForShop",
ylab="Consumption", cex=0.5, cex.lab=0.7, xlim=c(0,mx), ylim=c(0,mx_y), main="black=budget, red=value",
cex.main=0.7)
lines(z, d$ConsumptionValue / d$Price / corr, col="red", cex=0.5, type="p")
abline(h=0,v=0)
#z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
#plot(z, d$ConsumptionValue / d$ConsumptionBudget, cex=0.5, cex.lab=0.7, xlim=c(0,1), ylim=c(0,1),
#     xlab="Share of unsuccesfull trades")
#abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$ConsumptionValue, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$nCouldNotFindFirmWithGoods, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$nChangeShopInBuyFromShopLookingForGoods, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
z = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods) /  (d$n_Households*2)
plot(z, d$nChangeShopInSearchForShop, cex=0.5, cex.lab=0.7, xlim=c(0,1),
xlab="Share of unsuccesfull trades")
abline(h=0, v=0)
mx = max(max(d$nChangeShopInSearchForShop), max(d$nChangeShopInBuyFromShopLookingForGoods))
plot(d$nChangeShopInSearchForShop, d$nChangeShopInBuyFromShopLookingForGoods, xlab="nChangeShopInSearchForShop",
ylab="nChangeShopInBuyFromShopLookingForGoods", cex=0.5, cex.lab=0.7, log="xy", ylim=c(1,mx), xlim=c(1,mx), main="Log-scale")
abline(a=0,b=1, lty=2)
mx = max(max(d$nChangeShopInSearchForShop), max(d$nCouldNotFindFirmWithGoods))
plot(d$nChangeShopInSearchForShop, d$nCouldNotFindFirmWithGoods, xlab="nChangeShopInSearchForShop",
ylab="nCouldNotFindFirmWithGoods", cex=0.5, cex.lab=0.7, log="xy", ylim=c(1,mx), xlim=c(1,mx), main="Log-scale")
abline(a=0,b=1, lty=2)
#-----------------------------------------------
par(mfrow=c(3,3))
mn = min(d$ConsumptionValue)
mx = max(d$ConsumptionBudget)
plot(d$ConsumptionBudget, d$ConsumptionValue, cex=0.5, cex.lab=0.7, xlim=c(mn,mx), ylim=c(mn,mx))
abline(h=0, v=0)
abline(a=0,b=1,lty=2)
mx = max(d$ConsumptionBudget)
plot(d$nSuccesfullTrade, d$ConsumptionValue, cex=0.5, cex.lab=0.7, ylim=c(0,mx))
abline(h=0)
plot(d$nSuccesfullTrade, d$ConsumptionBudget, cex=0.5, cex.lab=0.7, ylim=c(0,mx))
abline(h=0)
unsuccesfulTrades = (d$nCouldNotFindFirmWithGoods+d$nChangeShopInBuyFromShopLookingForGoods)
plot(d$nSuccesfullTrade, unsuccesfulTrades, cex=0.5, cex.lab=0.7)
dev.off()
#-----------------------------------------------
if(F)
{
plot(d$Year, d$Sales/corr, type="l")
plot(d$Year, d$nEmployment, type="l")
plot(d$Year, d$PotensialSales/corr,  type="l")
plot(d_house$ConsumptionValue,  type="l")
plot(d$Year, d$PotensialSales/corr,  type="l", col="black")
lines(d$Year, d$Sales/corr,  col="red")
lines(d$Year, d$Production/corr,  col="blue")
lines(d$Year, 1000*d$nFirmNew,  col="green")
lines(d$Year, 15000-500*d$nFirmCloseNegativeProfit,  col="blue")
}
plot(d$nSuccesfullTrade, d$nZeroBudget, cex=0.5, cex.lab=0.7)
dev.off()
dev.off()
plot(d$nSuccesfullTrade, d$nZeroBudget, cex=0.5, cex.lab=0.7)
